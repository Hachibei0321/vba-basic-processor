# VBA基本処理コード - PDF取得後のデータ整理処理

関西のおばちゃん風コメント付きのVBAコードで、PDF取得後のExcelデータを自動整理する処理です♪

## 📁 ファイル構成

| ファイル名 | 説明 | 使用推奨 |
|------------|------|----------|
| `BasicProcessor_Complete.bas` | **完全版メインファイル** | ⭐ **これを使って！** |
| `DiagnosticTools.bas` | 診断用ツール | 必要に応じて |
| `BasicProcessor_Final.bas` | 最終版（追加要求前） | 参考用 |
| `Step2_Fixed_Final.bas` | Step2単体修正版 | 参考用 |

## 🚀 使い方

1. **VBAエディタを開く**
   - Excel で `Alt + F11` を押す

2. **コードをコピー**
   - `BasicProcessor_Complete.bas` の内容をコピー
   - VBAエディタに新しいモジュールを作成して貼り付け

3. **実行**
   - `基本処理_完全版()` を実行
   - または `F5` キーで実行

## 📋 処理内容（12ステップ）

### 【最初の処理群】
1. **Table001のB列削除**
2. **Table002の2行目削除** ← 🆕追加
3. **文字列削除**: （内作）（別注）（全ﾈｼﾞ）（非在庫品）を削除
4. **x→X変換**: 小文字を大文字に変換
5. **カタカナ半角変換**: 全角カタカナを半角に変換
6. **F10T変換**: `F10T M22X60` → `F10T-M20X60` ← 🆕追加
7. **S10T変換**: `S10T M22X60` → `S10T22X60` ← 🆕追加

### 【その後の処理群】
8. **空白行削除**: A~E列がすべて空欄の行を削除
9. **ネコアングル変換**: 連続6行のうち上から4行を変換 ← 🆕追加
   - `ﾈｺｱﾝｸﾞﾙ` → `ﾈｺｱﾝｸﾞﾙ D-10`
   - `ﾈｺｱﾝｸﾞﾙ` → `ﾈｺｱﾝｸﾞﾙ D-15`
   - `ﾈｺｱﾝｸﾞﾙ` → `ﾈｺｱﾝｸﾞﾙ D-20`
   - `ﾈｺｱﾝｸﾞﾙ` → `ﾈｺｱﾝｸﾞﾙ D-30`
10. **データ統合**: Table002のデータをTable001に統合
11. **テーブル形式解除**: Table002のテーブル形式を解除
12. **シート名変更**: Table001 → "原価リスト"

## 🔧 診断ツール

### 文字列診断（個別）
```vba
文字列診断_詳細版()
```
- 選択したセルの文字を1文字ずつ分析
- ASCIIコードとHEXコードを表示

### 範囲診断（全体）
```vba
範囲診断_削除対象文字列検索()
```
- シート全体から削除対象文字列を検索
- どこに何があるかを一覧表示

## 📊 実行結果の確認

実行後、イミディエイトウィンドウ（`Ctrl + G`）で詳細ログを確認できます：

```
=== ステップ1: B列削除開始 ===
Table001のB列を削除完了
=== ステップ1完了 ===

=== ステップ1.5: Table002の2行目削除開始 ===
削除する2行目の内容: データ1 | データ2 | データ3
Table002の2行目を削除完了
=== ステップ1.5完了 ===

=== ステップ2: 文字列削除開始（最終版・全角括弧対応） ===
削除: BN-55（別注） → BN-55
削除: 40WBL-N1（内作） → 40WBL-N1
Table001: 2個の文字列を削除
=== ステップ2完了（最終版・全角括弧対応） ===

（以下続く...）
```

## ⚠️ 注意事項

1. **シート名**: `Table001 (Page 1)` と `Table002 (Page 1)` が存在することを確認
2. **バックアップ**: 実行前に必ずExcelファイルのバックアップを作成
3. **全角括弧**: 実際のデータは全角括弧（）を使用（診断ツールで確認済み）

## 🐛 トラブルシューティング

### 文字列が削除されない場合
1. `範囲診断_削除対象文字列検索()` を実行
2. 実際の文字列形式を確認
3. 必要に応じてコードを調整

### エラーが発生する場合
1. シート名を確認
2. データの形式を確認
3. イミディエイトウィンドウでエラー内容を確認

## 🆕 バージョン履歴

### v3.0 完全版 (2025/06/18)
- F10T変換処理追加
- S10T変換処理追加
- Table002の2行目削除追加
- ネコアングル変換処理追加

### v2.0 最終版 (2025/06/18)
- 全角括弧（）対応
- テーブル解除エラー修正
- 診断ツール追加

### v1.0 初期版 (2025/06/16)
- 基本的な8ステップ処理

## 👩‍💻 作成者

関西のおばちゃん 😊

初心者にもわかりやすいコメント付きで作成してます♪
何かわからんことがあったら、遠慮せんと聞いてや〜！